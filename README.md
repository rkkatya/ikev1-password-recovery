# SPSHIA – IKEv1 Aggressive Mode Password Recovery

Лабораторная работа по восстановлению пароля в протоколе IKEv1 типа Aggressive Mode.

## Структура проекта

–   gen.py - генератор тестовых заданий
–   crack.py - модуль восстановления пароля
–   Репринцева.txt - тестовые данные (откуда берутся фиксированные значения)
–   test_data.txt - тестовые данные (те же, что в Репринцева.txt, но через *)
–   examples/ - примеры запуска (результаты от вызова gen.py)


## Генерация тестовых данных (gen.py)
usage: gen.py [-h] -m {md5,sha1} -p PASSWORD -f FILE [-o OUTPUT]

    – Генерация с MD5
    python3 gen.py -m md5 -p 123456 -f Репринцева.txt [-o examples/example_md5.txt]

    – Генерация с SHA1  
    python3 gen.py -m sha1 -p password -f Репринцева.txt [-o examples/example_sha1.txt]

    **Выходной формат:**
    `Ni*Nr*g_x*g_y*Ci*Cr*SAi*IDi*HASH`

    Пример работы:
    katya@Mac11 ikev1-password-recovery % python3 gen.py -m md5 -p 123456 -f Репринцева.txt
    f8429e9cb524fe8622e443615638828aedc718757de94513795748dd19be445c*a7513a2b8f4f7f8f46701b7e20974ae52b7ea965595cc646387db0d5fddb5338*693c1936e2e8f95abf09fbcdcba6f652189df8e5f39f70b5ab485cdece0b20d26e9ca9b1cfb65bf217f6b40d711235fe056156d63eaa9f5cc121b9bcaaa05b956dd8ee987735c9b771d90eec43391f939619e4236762cbc31333c94ea5662eec754006fb89c3aeb0f01c78ad2072d9a874780479ac3cc6449a3c98719423af12*9f2da0f4e761ffda6b4686837a9ce9d2c4a9471224200f8ba0d6d4a6a5502f6799ba0f7b0ba7311807a7ed87f9cc36a9a3a70ed89b9c2ef1ee846b9c250e465afa6bc2849341d9a606794074f17cd243f374832bc09be0a849df8dae2015c987bc96a3f96323062c19fc5c5a8b810ed7f73cf8a5db3bb8c813640a9380180d83*ae6cb5e9155fdf495c079ab03ae548b8*63b51f051966399fcd09977231ebdaf0*de8a386af3039a1eb716af77397060f6*3bb58992b598cb1d145f8e226e61d6a2*09482b8fbffbfe880d42c18578607ac1

## Восстановление пароля (crack.py)
usage: crack.py [-h] -m MASK [-p PROCESSES] test_file

    – Перебор пароля из 5 символов: 3 любых + 2 цифры
    python3 crack.py -m aaadd -p 4 test_file.txt

    – Перебор пароля из 6 символов: только маленькие буквы
    python3 crack.py -m llllll -p 4 test_file.txt

    – Комбинированная маска: заглавная + 3 любых + 2 цифры
    python3 crack.py -m uaaadd -p 4 test_file.txt

## Восстановление моего пароля из Репринцева.txt
    1. Переписали значения из Репринцева.txt в формат 'Ni*Nr*g_x*g_y*Ci*Cr*SAi*IDi*HASH' и засунули в файл test_data.txt 
    2. python3 crack.py -m aaaaaa -p 4 test_data.txt 
    3. Получили результат: ssss99

    [СТАТУС] Прогресс: 67.64% | Обработано: 30,910,500/45,697,600 | Скорость: 69000 пар/сек | Ожидаемое время окончания: 2025-
    [СТАТУС] Прогресс: 68.08% | Обработано: 31,112,500/45,697,600 | Скорость: 101000 пар/сек | Ожидаемое время окончания: 2025
    [СТАТУС] Прогресс: 68.51% | Обработано: 31,307,500/45,697,600 | Скорость: 97500 пар/сек | Ожидаемое время окончания: 2025-
    [СТАТУС] Прогресс: 68.90% | Обработано: 31,487,100/45,697,600 | Скорость: 89800 пар/сек | Ожидаемое время окончания: 2025-
    [СТАТУС] Прогресс: 69.26% | Обработано: 31,648,100/45,697,600 | Скорость: 80500 пар/сек | Ожидаемое время окончания: 2025-
    [СТАТУС] Прогресс: 69.60% | Обработано: 31,804,700/45,697,600 | Скорость: 78300 пар/сек | Ожидаемое время окончания: 2025-
    [СТАТУС] Прогресс: 69.80% | Обработано: 31,896,700/45,697,600 | Скорость: 46000 пар/сек | Ожидаемое время окончания: 2025-   

    ================================================================================
    ПАРОЛЬ НАЙДЕН: ssss99
    Затраченное время: 350.48 секунд
    Время окончания: 2025-11-29 01:42:47
    ================================================================================
    УСПЕХ: Пароль найден!
    
    *** 
    Конечно, правильно было бы реально использовать маску aaaaaa, но, имея ограниченные системные ресурсы, 
    используем маску lllldd, которую по счастливой случайности мы подобрали. В попытках еще больше сократить 
    время поиска пароля задействуем многопроцессорность и оптимизируем перебор, а именно: используем все ядра CPU 
    через Pool; разделяем алфавит между процессами без дублирования; используем itertools.product для минимальных 
    накладных расходов;периодически обновляем счётчик - избегаем частых блокировок; используем разделяемую 
    память - Manager для синхронизации прогресса между процессами; и, конечно же, параллельные вычисления - каждый 
    процесс независимо проверяет свой диапазон паролей.
    ***


## Маска пароля

– `a` - латинские символы + цифры
– `d` - только цифры (0-9)
– `l` - маленькие латинские символы (a-z)
– `u` - заглавные латинские символы (A-Z)
